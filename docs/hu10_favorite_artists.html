<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <!-- Fuerza layout tipo teléfono -->
  <meta name="viewport" content="width=390, initial-scale=1, maximum-scale=1, user-scalable=no">
  <meta name="theme-color" content="#ffffff">
  <title>Artistas Favoritos</title>

  <!-- Bootstrap 4.6.2 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"></script>

  <style>
    /* ====== MODO "MOBILE OBLIGATORIO" ====== */
    html, body { height: 100%; background: #f8f9fa; overflow-x: hidden; }
    body.force-mobile {
      max-width: 390px;        /* ancho fijo estilo app móvil */
      margin: 0 auto;
      -webkit-text-size-adjust: 100%;
    }

    /* Navbar */
    .navbar { padding: .5rem .75rem; }
    .navbar .btn-link { font-size: .95rem; }
    .navbar .h6 { font-weight: 700; font-size: 1rem; }

    /* Formulario */
    .input-group .form-control { border-radius: .75rem 0 0 .75rem; }
    .input-group .btn { border-radius: 0 .75rem .75rem 0; }

    /* Listas tocables */
    .list-group-item { background: #fff; padding: .85rem .75rem; }
    .list-group + .list-group { margin-top: .75rem; }

    /* Avatares y tipografía */
    .artist-avatar { width:48px; height:48px; object-fit:cover; border-radius:.35rem; }
    .font-weight-medium { font-weight:600; }
    small, .small { font-size: .9rem; }

    /* Botones compactos */
    .btn-sm { padding: .35rem .7rem; }

    /* Etiquetas sección */
    .section-label {
      text-transform: uppercase; letter-spacing: .02em;
      color:#6c757d; font-size: .8rem; margin: .25rem 0 .5rem;
    }

    /* Mejora táctil */
    * { touch-action: manipulation; }

    @media (max-width: 420px) {
      .list-group-item { padding: .8rem .7rem; }
    }
  </style>
</head>
<body class="force-mobile bg-light">

  <nav class="navbar navbar-light bg-white border-bottom sticky-top">
    <a href="hu03_artists.html" class="btn btn-link p-0">‹ Volver</a>
    <span class="mx-auto h6 mb-0">Favoritos</span>
    <span style="width:40px;"></span> <!-- espaciador para centrar título -->
  </nav>

  <div class="container py-3">

    <!-- Formulario de favoritos (no consume JSON, mapea estructura esperada) -->
    <form id="favForm" data-entity="favoritePerformers">

      <!-- Buscador para agregar artistas -->
      <div class="input-group mb-3">
        <input type="search" class="form-control" name="searchQuery" placeholder="Buscar artista para agregar">
        <div class="input-group-append">
          <button class="btn btn-outline-secondary" type="button" id="btnSearch">Buscar</button>
        </div>
      </div>

      <!-- Resultados de búsqueda (ejemplos estáticos; hidrátalos luego con tu backend) -->
      <div class="list-group mb-3" id="searchResults">

        <!-- Ejemplo resultado: Rubén Blades -->
        <div class="list-group-item d-flex align-items-center"
             data-performer-id="100"
             data-performer-name="Rubén Blades Bellido de Luna"
             data-performer-image="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Ruben_Blades_by_Gage_Skidmore.jpg/800px-Ruben_Blades_by_Gage_Skidmore.jpg"
             data-performer-birthdate="1948-07-16T00:00:00.000Z"
             data-performer-description="Cantante, compositor, actor y activista panameño.">
          <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Ruben_Blades_by_Gage_Skidmore.jpg/800px-Ruben_Blades_by_Gage_Skidmore.jpg"
               class="artist-avatar mr-3" alt="Rubén Blades">
          <div class="flex-fill">
            <div class="font-weight-medium">Rubén Blades Bellido de Luna</div>
            <small class="text-muted">Nac.: 1948-07-16</small>
          </div>
          <button type="button" class="btn btn-sm btn-outline-primary add-fav">Agregar</button>
        </div>

        <!-- Ejemplo resultado: Queen -->
        <div class="list-group-item d-flex align-items-center"
             data-performer-id="101"
             data-performer-name="Queen"
             data-performer-image="https://pm1.narvii.com/6724/a8b29909071e9d08517b40c748b6689649372852v2_hq.jpg"
             data-performer-creation-date="1970-01-01T00:00:00.000Z"
             data-performer-description="Banda británica de rock formada en 1970 en Londres.">
          <img src="https://pm1.narvii.com/6724/a8b29909071e9d08517b40c748b6689649372852v2_hq.jpg"
               class="artist-avatar mr-3" alt="Queen">
          <div class="flex-fill">
            <div class="font-weight-medium">Queen</div>
            <small class="text-muted">Desde: 1970-01-01</small>
          </div>
          <button type="button" class="btn btn-sm btn-outline-primary add-fav">Agregar</button>
        </div>
      </div>

      <!-- Mis favoritos -->
      <h6 class="section-label">Mis favoritos</h6>
      <div class="list-group" id="favoritesList">

        <!-- Ejemplo favorito precargado -->
        <div class="list-group-item d-flex align-items-center"
             data-performer-id="200"
             data-performer-name="Radiohead"
             data-performer-image="https://picsum.photos/seed/radiohead/48">
          <img src="https://picsum.photos/seed/radiohead/48" class="artist-avatar mr-3" alt="Radiohead">
          <div class="flex-fill">Radiohead</div>
          <!-- input oculto para enviar id del favorito -->
          <input type="hidden" name="favoritePerformers[]" value="200">
          <button type="button" class="btn btn-sm btn-outline-danger remove-fav">Quitar</button>
        </div>

      </div>

      <!-- Acción principal -->
      <button type="submit" class="btn btn-primary btn-block mt-3">Guardar favoritos</button>

    </form>
  </div>

  <script>
    // Añadir resultado a favoritos (solo front, sin consumir JSON)
    document.querySelectorAll('.add-fav').forEach(function(btn){
      btn.addEventListener('click', function(){
        var item = this.closest('.list-group-item');
        var id = item.dataset.performerId;
        var name = item.dataset.performerName;
        var img = item.dataset.performerImage || 'https://picsum.photos/48?random';

        // Evitar duplicados
        if (document.querySelector('#favoritesList [data-performer-id="'+id+'"]')) return;

        var wrapper = document.createElement('div');
        wrapper.className = 'list-group-item d-flex align-items-center';
        wrapper.setAttribute('data-performer-id', id);
        wrapper.setAttribute('data-performer-name', name);
        wrapper.setAttribute('data-performer-image', img);
        wrapper.innerHTML = `
          <img src="${img}" class="artist-avatar mr-3" alt="${name}">
          <div class="flex-fill">${name}</div>
          <input type="hidden" name="favoritePerformers[]" value="${id}">
          <button type="button" class="btn btn-sm btn-outline-danger remove-fav">Quitar</button>
        `;
        document.getElementById('favoritesList').appendChild(wrapper);
        // Wire del botón quitar recién creado
        wireRemove(wrapper.querySelector('.remove-fav'));
      });
    });

    // Quitar de favoritos
    function wireRemove(btn){
      btn.addEventListener('click', function(){
        this.closest('.list-group-item').remove();
      });
    }
    document.querySelectorAll('.remove-fav').forEach(wireRemove);

    // Validación mínima de envío (opcional)
    (function(){
      var form = document.getElementById('favForm');
      form.addEventListener('submit', function(e){
        // Si deseas, exige al menos un favorito
        // if (!document.querySelector('#favoritesList [name="favoritePerformers[]"]')) {
        //   e.preventDefault(); alert('Agrega al menos un artista favorito');
        // }
      });
    })();
  </script>

</body>
</html>
