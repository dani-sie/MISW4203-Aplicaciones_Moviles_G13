<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Artistas Favoritos</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha256-DrT5Nf7bQxN1Z5qX6Ch12eDqOohMHDL/95B2S/bjhp4=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"></script>
<style>
  .artist-avatar { width:48px; height:48px; object-fit:cover; border-radius:.25rem; }
  .font-weight-medium { font-weight:600; }
</style>
</head>
<body class="bg-light">

<nav class="navbar navbar-light bg-white border-bottom sticky-top">
  <a href="hu03_artists.html" class="btn btn-link p-0">‹ Volver</a>
  <span class="mx-auto h6 mb-0">Favoritos</span><span></span>
</nav>

<div class="container py-3">

  <!-- Formulario de favoritos (no consume JSON, mapea estructura esperada) -->
  <form id="favForm" data-entity="favoritePerformers">

    <!-- Buscador para agregar artistas -->
    <div class="input-group mb-3">
      <input type="search" class="form-control" name="searchQuery" placeholder="Buscar artista para agregar">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary" type="button" id="btnSearch">Buscar</button>
      </div>
    </div>

    <!-- Resultados de búsqueda (ejemplos estáticos; hidrátalos luego con tu backend) -->
    <div class="list-group mb-3" id="searchResults">

      <!-- Ejemplo resultado: Rubén Blades -->
      <div class="list-group-item d-flex align-items-center"
           data-performer-id="100"
           data-performer-name="Rubén Blades Bellido de Luna"
           data-performer-image="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Ruben_Blades_by_Gage_Skidmore.jpg/800px-Ruben_Blades_by_Gage_Skidmore.jpg"
           data-performer-birthdate="1948-07-16T00:00:00.000Z"
           data-performer-description="Cantante, compositor, actor y activista panameño.">
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bb/Ruben_Blades_by_Gage_Skidmore.jpg/800px-Ruben_Blades_by_Gage_Skidmore.jpg"
             class="artist-avatar mr-3" alt="Rubén Blades">
        <div class="flex-fill">
          <div class="font-weight-medium">Rubén Blades Bellido de Luna</div>
          <small class="text-muted">Nac.: 1948-07-16</small>
        </div>
        <button type="button" class="btn btn-sm btn-outline-primary add-fav">Agregar</button>
      </div>

      <!-- Ejemplo resultado: Queen -->
      <div class="list-group-item d-flex align-items-center"
           data-performer-id="101"
           data-performer-name="Queen"
           data-performer-image="https://pm1.narvii.com/6724/a8b29909071e9d08517b40c748b6689649372852v2_hq.jpg"
           data-performer-creation-date="1970-01-01T00:00:00.000Z"
           data-performer-description="Banda británica de rock formada en 1970 en Londres.">
        <img src="https://pm1.narvii.com/6724/a8b29909071e9d08517b40c748b6689649372852v2_hq.jpg"
             class="artist-avatar mr-3" alt="Queen">
        <div class="flex-fill">
          <div class="font-weight-medium">Queen</div>
          <small class="text-muted">Desde: 1970-01-01</small>
        </div>
        <button type="button" class="btn btn-sm btn-outline-primary add-fav">Agregar</button>
      </div>
    </div>

    <!-- Mis favoritos -->
    <h6 class="text-uppercase text-muted">Mis favoritos</h6>
    <div class="list-group" id="favoritesList">

      <!-- Ejemplo favorito precargado -->
      <div class="list-group-item d-flex align-items-center"
           data-performer-id="200"
           data-performer-name="Radiohead"
           data-performer-image="https://picsum.photos/seed/radiohead/48">
        <img src="https://picsum.photos/seed/radiohead/48" class="artist-avatar mr-3" alt="Radiohead">
        <div class="flex-fill">Radiohead</div>
        <!-- input oculto para enviar id del favorito -->
        <input type="hidden" name="favoritePerformers[]" value="200">
        <button type="button" class="btn btn-sm btn-outline-danger remove-fav">Quitar</button>
      </div>

    </div>

    <!-- Acción principal -->
    <button type="submit" class="btn btn-primary btn-block mt-3">Guardar favoritos</button>

  </form>
</div>

<script>
  // Añadir resultado a favoritos (solo front, sin consumir JSON)
  document.querySelectorAll('.add-fav').forEach(function(btn){
    btn.addEventListener('click', function(){
      var item = this.closest('.list-group-item');
      var id = item.dataset.performerId;
      var name = item.dataset.performerName;
      var img = item.dataset.performerImage || 'https://picsum.photos/48?random';

      // Evitar duplicados
      if (document.querySelector('#favoritesList [data-performer-id="'+id+'"]')) return;

      var wrapper = document.createElement('div');
      wrapper.className = 'list-group-item d-flex align-items-center';
      wrapper.setAttribute('data-performer-id', id);
      wrapper.setAttribute('data-performer-name', name);
      wrapper.setAttribute('data-performer-image', img);
      wrapper.innerHTML = `
        <img src="${img}" class="artist-avatar mr-3" alt="${name}">
        <div class="flex-fill">${name}</div>
        <input type="hidden" name="favoritePerformers[]" value="${id}">
        <button type="button" class="btn btn-sm btn-outline-danger remove-fav">Quitar</button>
      `;
      document.getElementById('favoritesList').appendChild(wrapper);
      // Wire del botón quitar recién creado
      wireRemove(wrapper.querySelector('.remove-fav'));
    });
  });

  // Quitar de favoritos
  function wireRemove(btn){
    btn.addEventListener('click', function(){
      this.closest('.list-group-item').remove();
    });
  }
  document.querySelectorAll('.remove-fav').forEach(wireRemove);

  // Validación mínima de envío (opcional)
  (function(){
    var form = document.getElementById('favForm');
    form.addEventListener('submit', function(e){
      // Si deseas, exige al menos un favorito
      // if (!document.querySelector('#favoritesList [name="favoritePerformers[]"]')) {
      //   e.preventDefault(); alert('Agrega al menos un artista favorito');
      // }
    });
  })();
</script>

</body>
</html>
